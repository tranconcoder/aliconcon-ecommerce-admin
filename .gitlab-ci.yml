include:
  - project: tvconss/gitlab-tools
    ref: main
    file: sync-to-github/.gitlab-ci.yml

stages:
  - sync-to-github
  - deploy_client_admin

variables:
  GITHUB_REPO: "aliconcon-ecommerce-admin"

deploy_client_admin:
  stage: deploy_client_admin
  tags:
    - shell
  variables:
    DEPLOY_DIR_PATH: "/var/www/aliconcon-ecommerce_client-admin"
    CI: "false"
  before_script:
    - source /home/gitlab-runner/.bashrc

  script:
    # Install packages
    - echo "ðŸš§ Installing dependencies..."
    - bun install

    # Handle build project
    - echo "ðŸ”¨ Building project..."
    - bun run build

    # Deploy (only runs if build succeeds)
    - echo "ðŸš€ Deploying to $DEPLOY_DIR_PATH..."
    - rm -rf $DEPLOY_DIR_PATH
    - mkdir -p $DEPLOY_DIR_PATH
    - cp -r ./build/* $DEPLOY_DIR_PATH

    - echo "âœ… Deployment Complete!"

  only:
    - master